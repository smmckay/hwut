Often the same test program is applied with only one or few parameters changed.
Someone might have a parsing function that works on 7, 8, 16 and 32 bit encoded
unicode characters. The functions may be the same and so are the testing
functions. The only requirement is use different encodings for one and the same
test.  Here, _choices_ come handy. HWUT is able to pass an a 'choice' string of
a list of possible choices to a test program. The test program can then decide
based on the command line argument what test to run.  To be able to do so, HWUT
must know what the choices for a program are, and thus, the program needs to
report them when it is called with `--hwut-info` as first argument. HWUT
requires to report the choices after a `CHOICES:` keyword, where the different
choices are comma separated. For the example mentioned above the reponse to
`--hwut-info` in C might be produced by a code fragment like this: 

[C]
source~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
...
int main(int argc, char** argv)
{
    uint8_t*  test_string = 0x0;

    if( argc > 1 )
        if( strcmp(argv[1], "--hwut-info") == 0 ) {
            printf("My String Function Under Heavy Test\n");
            printf("CHOICES: 7bit, 8bit, 16bit, 32bit");
            return 0;
        }
        elif( strcmp(argv[1], "7bit") == 0 ) {
            test_string = create_7bit_encoded("this is a test\n\t ...");
        }
        elif( strcmp(argv[1], "8bit") == 0 ) {
            test_string = create_8bit_encoded("this is a test\n\t ...");
        }
        ...
    }
    // test on 'test_string'
    ...
}
source~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The storage of results and the result reporting will now include the choices
passed to a given test program. Note, however, that this feature does not
directly support compile options. For C programs, for example, it should be
common practice to test with and without the `NDEBUG` macro defined. Otherwise,
panic might come up as soon as a program is run at full speed and errors
pop out of nowhere, only because some assert commands or `#ifndef
NDEBUG` commands have been written uncarefully. 

An elegant way to deal with compile options is to put the makefile into
another directory (other than `TEST`) and then initiate the compile process
from a shell script that is located in the TEST directory. For the quex
project this technique is applied to compile the tests for the demo
programs. A shell script that intiates the compilation process and starts
the test program looks for example like this:

[shell]
source~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#! /usr/bin/env bash
if [[ $1 == "--hwut-info" ]]; then
    echo "demo/002: Indentation Based Scopes"
    echo "CHOICES:  NDEBUG, DEBUG"
    exit
fi
source core.sh 002 $1
source~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

where the script `core.sh` on which it relies is used by all test programs.
It initiates the compilation and runs the test and ensures that the
standard output is delivered as desired. It receives the directory
where to find the makefile as a first argument and the compile
option as a second argument. In principle such a shell script
looks like this:

[shell]
source~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cd $1 
if [[ $2 == "NDEBUG" ]]; then
    arg1="NDEBUG_F=-DNDEBUG"
else
    arg1="NDEBUG_F= "
fi
echo "makefile =" Makefile
echo "cleaning ..."
make clean   >& /dev/null
echo "make $arg1"
make  $arg1 >& /dev/null
echo "executing ..."
./test-program
echo "cleaning ..."
make clean >& /dev/null
source~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Note, that is sets the `NDEBUG` flag according to the choice which was chosen
for the test program. 
